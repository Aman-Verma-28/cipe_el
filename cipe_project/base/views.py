from django.shortcuts import render
from rest_framework.views import APIView
from pyChatGPT import ChatGPT
from rest_framework.response import Response
from .models import Chat
from uuid import uuid4
# Create your views here.


class ChatView(APIView):
    def get(self, request):
        data = request.data
        session_token = 'eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..zRb_pTf9tRvuTfWp.Jf1uWKVjpO2176oRhJLMCkxWLKwOBS-8jYuSCg12MYSaH3pP36K0h8N8C9FexTsiNyCBNfdn1h2k54SgeyK3gA3kawLe5m2ipqHl_uTka9U3YyUKjfV_ckacDAouBh4CUa7_yTbLnjGcXMzeVJPs-tTh0_RWFNNTVTI3H4oyMVrFSM5y2aXkgIstY2lnsKwTV1ceBQF3928EYnJgxiRCTDCk823t990pKMiVrkwLQzV87uiGcOiG5K07KkzxSJj4_7IBiSgzI382kskFVE_uKRhu_3jjQScPs4W6g1P_KbHOxHQRfHq7b4iSvWbs_PY37A8bdV90i2KfcFdanFA3HwyylzOvLh71eM2eAmLyLtMn8R1SZ_fUO_hMOjEsZso8lBFbg30EYnOvqXueGu8yn64w3_gdmXkGk6uQ1gIOpKJ31SnJHbpVtUYxhwGaH9CZKQz6wi-vzuAguHfUOL3x2Ysn2je_ezgXO95lQRu0w6ZofxaX7U9UJUAV97okPmT5V3gCVxqqzHp2Wx9hn3I-T0LvFql_Vw0mqR3B-82GrLPc1eSxF0cxFhN_d6d3AJwOTj08JaRohod_CQRZjA9S_TXO6vsZfxcqB6jy2YpRnkkONeSUAzOiGceK7lbpyLpkG52d2A5HBtZXxwXVDlcXLVZvRlBTP_UqicHax2mKpt3qUtOgJLXExp2KlNdHX3RY04uqNiFc5N4UXd4i9ozusZGB3FU-dHK3rzOyl7dXuxr8KnviXnuhyj0ZPETcDH8hNLhzm7Lo4fDr3fc1Z3G2pPFFb-FPPJe39bMGuBEUA2Qbf401_rwj09F-3SE3LSKASdqzKXDN0Kz0vAFRbGH_Pb967-NOWMx_UhQiIcyk4tDJS5Giq7WPme0UdjMn4TLaKuiKfjXiaLz6oA-UevRh7qEsrgvnK_DfOK7dXFqnbZFpKlsnRJpXcDiJWf62dhUPk1I2R3xo7Uj4gyrehwauPJxQ3_7MHvZ231fd-JF8le1JEqYmBAIVDaGAvTEXvpsuQQhb6tnwYYf_zKjsDwgm0CnxLFR-2iMTauky6FABB5j-emmem6TUniYrzeWSyuBXfEDnTI4kkJZ6yvPbmgMQio9KykdHERs-ZPa2d5i5pS2DLBiEIRK3IB8NbDoZcH_QkfI9W4YMmJEvurh-U22XNuvqzaUpQWtoNBcVhPn4HfNjoAMahBeiY3h1Uk2PgiKsKnAy6KXOATb4Ld9bz2HimhTJpGmH-FfHxj1GFZYEMBxj6g0MvpL-aJKinQitGoD2Xntn0Veg7ueYK18stpx9j9rKtSu4iz-hvSFOPItUY5FHzn2QGS2OnrZ8nzjJqJh6ZqM-uQhUnlIH0LiTraIs1DPfSlv_tLvLgJRp1-b7sY3NbN63oKdW12Vp84KoY1MCcV11eqP0fOvSK1XodDSFfdibYSRUeRMAncNbBDs6JZkInjBR08_rVAn7fRFcYE8IeYJalR3L8pD-G2fLlwOgDqCkZ5jZnN_w4YiT3dmwW2L2MnkhensOlH5gLsjMJGyFTop6hRTvD6jMJIBSmpqpGm7sE4zDMyGdSOIbAANa6wTQmUaTEfuDVBsedOEu6agcBlhx0J5uffAZ9ncO1TRHyPDXxNDx-iqnHs8sx0viPgWIjoN9Q37iEBWtjYLQU711wN3DCgdMWqWH3OHUyP8TM1t6Pm4ekf_CUZhTvfhFEtAXK17MPGo4g4lvb3vItBpL2aA2VJmRxIdnko2s8OYj4DfQZXSHZLBqRMJZGrbnahLvzSw7C1HDlv5eJKDX9tL0SBeTr42OvZw6wiZ9znG21jbQm4k10zojy0R2QoGyzsK90pQKvCdBlIwbv_nT_yQXWVJK2-yyX6Ay3AeKYWmZUR5Nn1xg2TaOfUVSVBko0PwWdWesavkYSqnImTdf85HBiUPoIWj_SfTdt7XhPQNEplUbfND9YuIcSEZPwTumFOoUZUPre0lI1ry3ODIJINRVhBgerEqJUg09stDpS37fMTiRc6sgcGcgYpxjOEfIO5QovASMmaRd-4X3FDFU-Pi1z1IaAxB5ZPYrtjk6dqviR27oQbXk7oKv0lZr81MallnlQmwl8LXmM29RBdRudHXKLmsJbUHSDxkzDmjVAY4pVWLWXOrRDvec8-k5A84B8PmQNJSdtWAKHqhCvQsOF6s4BZ-KlGY27AUEFAg4gPuRZWDyAVfJ4C8ty6k1iJsJAoR1qO_IbNOiz2LPgsOSY-Iqx1oDy5E7qVAKd-ZuSjT9WUPjFfnyhS3CVWhDqHcVWhEK-ASwlPovuL3uMUZbYBP3oTHN1KB0gDjDd170h92bnTEySFLF6kumuWayA4WxzwM4YJQZ05_OzqJlEqz2N4NXtPX-WebnU2yxu-E9lF3TvBmLf1e2obQuxy8.oieLJiWDH0Q9A-2ijCUBWQ'
        sesssion_token = 'eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..vWS8M94tbdHaPwcD.bvJfXKA1e7AGEdUFilbJiESL2hW0mbCIstoGzPrlmC6a_Ernc4BbjpBBj959c8A-Ata57u6hV9pYvv-de133tdq2EaR3-CtGioUfqZoVWg0eGr5qDFRRcnR3O3xPUubwQk_uZSl4K6fCHC-E0Z4uMUVgwP94YO0JIV718_iqJY_5dJyzsiOSITRdeOYluFTN1xubEFWNBjDlsMY5GbcHJIGqQMKFITexG4KYEeHAsCRxULu3bk1M6HCQjxqX0eYH2ZYYlaIyj5mHDfafT9Cqc8sT9b1kDekgAjRAIErU405iYOL7eAaCwPSZWc66v8IsP1z9k3qQzi_jG6gLl9EBlIJDYehj9PAfnmSsx5rv5DCSC5KwW6VphtmBdCET1Sm9iLfVv6wrV7mZKLBnx2NrCt6KnCoq3Xoc3EQ9T3sCFXc6F0iDdTCMhDIfXHgadDYdJuM6-EzbH1vG9X_E1xDpouu8WKErEcD2_fHCX8Cpv9hRg9loo5OCIYKfdzUthlKvoV7R6TXLLsmIO4HzuzdDl749e77H56Q7FTx59QR8vPnQslUiY2jrtVHfJeoY-KKXY2Nu4IZoJBSqieAnvIMdjTUHiGHBoGoJRFbsX4Y8fdELylN9dqrVk4oa1wtIi1D0VdpcIZIWKeraLbvIySbKUaFlx3p2pori9fegvCx17InlfkJw7j6JcfWQYh9NLXjiujeY0bA8O3A8Zhj5kLXW2LhCFZ4Qfot9Yd78Z-VtsAAE8LLCguGlVjLBmIrvK5KxOT4B9UvWJyhECFXp1h0kv11hUNUdO2jo60jWwRzBeck6luGkkXwr3mpoBXWoTm8KBQJ9UQwXjb35FWhAW4pXE1VizSSudeGJRI8LNwt5nK1NlzYbjf4JK3wk9u30hVh2b7enlcYjglKQsDjBlqMmVqcfKLr_870UrtrtLnchtzvOx6c2Ub67V_vB2AMNvgQREl2Lz0IT_on-TtQXifwT0me7SRDKcNaR-YDJFkenQ1uYwvVI4knrxR_LHw0KM8JJx3TH4ZKoCaZpx7hvP1xR8qoKsmg3R-Dq8zcnFqs5g3Wikofou4DPe-O4Mc21xF7jNNko5aHnbvjT1SdkW-a399TKQ0B_v8BNbgfVXmc2oflf2sSB4fENeu4BnBlPyXEMwKHiuboE1OiPYMpfXDA9g4BnrbY_MLVRHXC7nxRBpz9DAmxfJZdwI1SYngDgr5qzHwNhjALW5qaSw6dhYVzbHJuBBSkjZDimBkrmnkx7b_gdiq-98xxJOD1z51f54M3Hz0gaY6XgJatr2wSGKUadCgpcWKhV5YXS6uo5fxvbUvTngGPPFSp-1K9JSnMJdvijKiO0NtyVzZFKR_0POkDLk6Rw-Ej9gR6dhyHzNoTAbpzewIMqWs6iK0dg4bvcI8ePef5njALP-8-qicLR_Oa6DdTdpxWeCcU4kYldgYKt2Z-4MsRZ0ToM78PT-nYi73tK8CaQqR0PSDuosi40ZaU0KxkhbKuZPb9NB6icm3OJuPL8WnaKa1mLuHZXRnRxyO3QxQU5pjreAWTX3PHd__iVHIkXw7VZnCfrXr1XCjyiixHIHVkTmLWGoyMVwuEFGWpSLjH5Mwl0u_xr9Sf9d_e--0qN8IU0GXQQGgZGxPa8W-z4TGLwkxYlE4BkHN4Z-XBSOMHIBemeQ5riweKd_e5N-X1-8C85NsVftHjeCCrEIbRGdMBMJcxhpkvX1LpW40slfBPBBvOor0d_sAz9nPRaQHbSPsOKczFRmKRLqClQUFXtfTmLGHoEfja61j-licDUki-crsMmukaL8QXnx-JpoYYRgsT-s-lHIKzS1mkZ24snfJGpXUEd2p1d8TRjK2O68MTmNb9-8_LTlM6i1Uh_xLWXbMCb3QPbULyPPWLjidmIslzH3x2TAwezos8v7vmOZCvK6tDhQaBI2Z-Ji5xCNp5hhaKPxfTcFqUDJ2JELbTkBa6MxkPbqU1pGOf9I43AhjEuH9xahcocy_LWhFQBRcrsDCYrBK5uLFudYtCvfNGttb5EkH3_1bpEeTma64p13WclBG91ltSus_tERwTwUBsUJc-2sAbe9mf0aESZGeLjmO98Sfm8Eu5sRX7h9CZ4fZCJJ811QIkmYGdF_qXPBufTe79GHgZ0qc7qAlpzCPgKTNGCYwJaRX25OxnkwJONnEy3AiSn1YEkemlIgTgWwPmKdzRJ0mbEppai3173bFVTJncySLCtgCZAGmMe4470YoBatvbCuyVlXzQ9XSDxNAV0mNb1TnDQ2XNAi7haoctyvIq75mWXmD6-orjK5zo3O7AWC6JatcHe1-yedVLKfn4bqJyCzG1XH_q7P-eG_fTT-cNVLNe3TMdyC-sS7Uxnfg2lVFn4WzYql0QMUI_sCicIO_tqSsgpCjo.UJDifEVBx4a2CJG4hYj7dA'
        # chatgpt = ChatGPT(session_token)
        
        chatgpt = ChatGPT(auth_type='google', email="amanforpersonaluse@gmail.com", password="amanChatGPT")
        message = data.get("message")
        response = chatgpt.send_message(message)
        print(response['message'])
        Chat.objects.create(message=message, response=response['message'], conversation_id=response['conversation_id'])
        return Response(response)

class LoginView(APIView):
    def get(self, request):
        token = uuid4()
        return Response({"token": token})
